0.。000
0










.0# 并发控制
- 事务可以一个一个的串行，即每个时刻只有一个事务运行
- 在单处理机中，事务的并行执行实际上是这些并行事物的并行操作轮流交叉运行
	- 减少了处理机的空闲时间，提高了系统的效率
## 并发控制概述
- 事务时并发控制的基本单位，保证事务的ACID特性是事务处理的重要任务
- 为了保证事务的**隔离性和一致性**，数据库管理系统需要对并发操作进行正确的调度，这就是数据库管理系统并发控制机制的责任
- 并发操作带来的数据不一致性包括，**丢失修改，不可重复读和读脏数据**
	- 丢失修改
		- T1 和 T2 事务读入同一数据并修改，T2 提交的结果破坏了T1 提交的结果，导致T1提交的结果修改被丢失
	- 不可重复读
		- 事务T1 读取某一个数据后，事务T2 对其进行修改/删除/增加数据项，当事务T1 再次读取该数据时，得到与前一次不同的值。
	- 读脏数据
		- 指T1修改某一数据并将其写回磁盘，事务T2 读取同一数据后，T1由于某种原因被撤销。这是T2读到的数据就与数据库中的数据不一致，则T2得到的数据就为脏数据，即不正确的数据
- 并发控制的机制就是要用正确的方式调度并发操作，时一个用户事务的执行不受其他事务的干扰从而避免造成数据的不一致性
- 并发控制的主要技术有**封锁，时间戳，乐观控制法和多版本并发控制**等
## 封锁
- 封锁是实现并发控制的一个非常重要的技术
	- 排他锁
		- 又称为写锁。若事务T对数据对象A加上X锁(排他锁)，则只允许T读取和修改A，其他任何事务都不允许在对A加任何类型的锁，直至A上的X锁释放为止。
		- 保证了其他事物在T释放A上的X锁之前，不能读取和修改A。
	- 共享锁
		- 又称为读锁。若事务T对数据对象A加上S锁(共享锁)，则事务T可以读A，当不能修改A。其他事物只能在对A加S锁，而不能加X锁，知道T释放A上的S锁为止。
		- 保证了其他事务可以读A，但在T释放S锁之前，其他事物不能修改A。
## 并发调度的可串行性
- 可串行调度
	- 定义：多个事务的并发执行是正确的，当且仅当其结果与按某一次序串行地执行这些事务时的结果相同
	- 可串行性：是并发事务正确调度的准则。一个给定的并发调度，当且仅当它是可串行化的才是正确的调度
- 冲突可串行化调度
	- 冲突操作时指不同事务对同一个数据的读写操作和写写操作
	- 一个调度sc在保证冲突操作的次序不变的情况下，通过交换两个事务不冲突操作的次序的到另一个调度sc'，如果sc'是串行的，则称调度sc为冲突可串行化调度
	- 若一个任务是冲突可串行化的，则一定是可串行化调度。因此可以用这种方法来判断一个调度是否是冲突可传性化的。
	- 冲突可串行调度是可传性化调度的**充分条件**，不是必要条件
	- 判断可串行化调度的充分条件