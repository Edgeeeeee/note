# 应用层
- 应用层协议特点
	- 每个应用层协议都是为了解决某一类应用问题，而问题的解决又往往是通过位于不同主机中的多个应用进程之间的通信和协同工作来完成的。应用层的具体内筒就是规定应用进程在通信时所遵循的协议。
	- 应用层的许多协议都是基于客户服务器方式。客户和服务器都是指通信中所涉及的两个应用进程。客户服务器方式所描述的是进程之间服务和被服务的关系，客户是服务请求方，服务器是服务提供方。
### 域名系统DNS
##### 域名系统概述
- 许多应用层软件经常直接使用**域名系统DNS**，但计算机的用户只是间接而不是直接使用域名系统
- 互联网采用层次结构的命名树作为主机的名字，并使用**分布式**的域名系统DNS。
- 名字到IP地址的解析是由若干个域名服务器程序完成的。域名服务器程序在专设的结点上运行，运行该程序的机器称为**域名服务器**
##### 互联网的域名结构
- 互联网采用了层次树状节构的命名方法。
- 任何一个连接在互联网上的主机或路由器，都有一个**唯一**的层次结构的名字，即**域名**
- 域名的节构由标号序列组成，各标号之间用点“.”隔开：
	- ![VaMYPe.png](https://s2.ax1x.com/2019/06/06/VaMYPe.png)
	- 各标号分别代表不同级别的域名
- 域名只是个**逻辑概念**，并不代表计算机所在的物理地点。
- 变长的域名和使用有助记忆的字串，是为了便于人来使用。而IP地址是定长的32位二进制数字则非常便于机器进行处理。
- 域名中的点和点分十进制IP地址中的点并无一一对应关系。点分十进制IP地址中一定是包含三个点，但每一个域名中点的数目不一定正好三个。
- 顶级域名	
	- **国家级顶级域名nTLD**
		- .cn表示中国
		- .us表示美国
		- .uk表示英国，等等
	- **通用顶级域名gTLD**
		- .com表示公司和企业
		- .net表示网络服务机构
		- .org表示非营利性组织
		- .edu美国专用的教育机构
		- .gov美国专用的政府部门
		- .mil美国专用的军事部门
		- .int表示国际组织
	- **基础结构域名**
		- 这种顶级域名只有一个，即**arpa**，用于反向域名解析，因此又称为**反向域名**
- 互联网的域名空间
	- ![VaMWMn.png](https://s2.ax1x.com/2019/06/06/VaMWMn.png)
##### 域名服务器
- 一个服务器所负责管辖的（或有权限的）范围叫做**区**
- 各单位根据具体情况开划分自己管辖范围的区。但在一个区中的所有节点必须是能够联通的。
- 每一个区设置相应的**权限域名服务器**，用来保存该区中的所有主机的域名到IP地址的映射。
- DNS服务器的管辖范围不是以域为单位，而是以区为单位
- 区的不同划分方法举例
	- ![VaMXs1.png](https://s2.ax1x.com/2019/06/06/VaMXs1.png)
- 树状结构的DNS域名服务器
	- ![VaQ1Qs.png](https://s2.ax1x.com/2019/06/06/VaQ1Qs.png)
- 域名服务器有以下四种类型
	- 根域名服务器
	- 顶级域名服务器
	- 权限域名服务器
	- 本地域名服务器
- 根域名服务器
	- 根域名服务器是**最高层次**的域名服务器，也是**最重要**的域名服务器。所有的根域名服务器都知道所有顶级域名服务器的域名和IP地址。
	- **不管是哪一个本地域名服务器，若要对互联网上任何一个域名进行解析，只要自己无法解析，就首先求助于根域名服务器**
	- 在互联网上共有13各不同IP地址的根域名服务器，他们的名字使用一个英文字母命名，从a到m
	- **根域名服务器共有13套装置，不是13个机器**
	- 到2016年2月，全世界已经在588个地点安装了根域名服务器，使世界上大部分DNS域名服务器都能**就近**找到一个根域名服务器。
	- 根域名服务器并不直接把域名直接转换成IP地址。
	- 在使用迭代查询时，根域名服务器把下一步应当找的顶级域名服务器的IP地址告诉本地域名服务器。
- 顶级域名服务器
	- 定义域名服务器（即TLD服务器）负责管理在该定义域名服务器注册的**所有二级域名**
	- 当受到DNS查询请求时，就给出相应的回答。（可能是最后的结果，也可能是下一步应当找的域名服务器的IP地址）。
- 权限域名服务器
	- 负责一个区的域名服务器
	- 当一个权限域名服务器还不能给出最后的查询回答时，就会告诉发出查询请求的DNS客户，下一步应当找哪一个权限域名服务器。
- 本地域名服务器
	- 本地域名服务器对域名系统非常重要
	- 当一个主机发出DNS查询请求时，这个查询请求报文就发送给本地域名服务器
	- 每一个互联网服务提供者ISP，或一个大学，甚至一个大学里的系，都可拥有一个本地域名服务器
	- 这种域名服务器有时也称为**默认域名服务器。**
- 提高域名服务器的可靠性
	- DNS域名服务器都把数据复制到几个域名服务器来保存，其中的一个是**主域名服务器**，其他的是**辅助域名服务器**。
	- 当主域名服务器出故障时，辅助域名服务器可以保证DNS的查询工作不会中断。
	- 主域名服务器定期把数据复制到辅助域名服务器中，而更改数据只能在主域名服务器中进行。这样就保证了数据的一致性。
- **域名的解析过程**
	- **主机向本地域名服务器的查询一般都是采用 递归查询 **。如果主机所询问的本地域名服务器不知道被查询域名的IP地址，那么本地域名服务器就以DNS客户的身份，向其他根域名服务器继续发出查询请求报文。
	- **本地域名服务器向根域名服务器的查询通常采用 迭代查询 。**当根域名服务器收到本地域名服务器的迭代查询请求报文时，要么给出所要查询的IP地址，要么告诉本地域名服务器：“你下一步应当向哪一个域名服务器进行查询”。然后让本地域名服务器进行后续的查询。
	- ![VahHb9.png](https://s2.ax1x.com/2019/06/06/VahHb9.png)
- 名字的高速缓存
	- **每个域名服务器都维护一个高速缓存**，存放最近用过的名字以及从和出货的名字映射信息的记录。
	- 可大大减轻根域名服务器的负荷，使互联网上的DNS查询请求和回答报文的数量大大减少。
	- 为保持高速缓存中的内容正确，域名服务器应为每项内容设置计时器，并处理超过合理时间的项（例如，每个项目指存放两天）
	- 当权限域名服务器回答一个查询请求时，在相应中都指明绑定有效存在的时间值。增加此时间值可减少网络开销，而减少此时间值可提高域名转换的准确性。
### 文件传送协议
##### FTP传送
- FTP概述
	- **文件传送协议**FTP是互联网上使用的最广泛的文件传送协议
	- FTP提供**交互式**的访问，允许客户指明文件的类型与格式，并允许文件具有存取权限
	- FTP屏蔽了各计算机系统的细节，因而适合于在异构网络中任意计算机之间的传送文件。
- 文件传送并非很简单的问题
	- 网络环境中的一项基本应用就是将文件从一套计算机中复制到另一台可能相距很远的计算机中
	- 出栏起来，在两个主机之间传送文件是很简答的事情
	- 其实这往往很困难。原因是众多的计算机厂商研制出的文件系统多大数百种，且差别很大。
##### FTP的基本工作原理
- 网络环境下复制文件的复杂性：
	- 计算机存储数据的格式不同
	- 文件的目录节构和文件命名的规定不同。
	- 对于相同文件的存取功能，操作系统使用的命令不同。
	- 访问控制方法不同。
- FTP特点
	- 文件传送协议FTP只提供文件传送的一些基本服务，他**使用TCP可靠的运输服务**。
	- FTP的主要功能时间少或消除在不同操作系统下处理文件的不兼容性。
	- FTP使用**客户服务器方式**，一个FTP服务器进程可同时为多个客户进程提供服务。FTP的服务器进程由两大部分组成：**一个主进程**，负责接收新的请求；另外有**若干个丛属进程**，负责处理单个请求。
- 主进程的工作步骤
	- 打开熟知端口（21），使客户进程能够连接上。
	- 等待客户进程发出连接请求
	- 启动从属进程来处理客户进程发来的请求。丛书进程对客户进程的请求处理完毕后即终止，但从属进程在运行期间需要还可能创建其他的一些子进程。
	- 回到等待状态，继续接受其他客户进程发来的请求。主进程与从属进程处理是并发地进行。
- 连个连接
	- **控制连接**在整个会话期间一直保持打开，FTP客户发出的传送请求通过控制连接发送给服务器端的控制进程，但控制连接不用来传送文件
	- 实际用于传输文件的使**数据连接**。服务器端的控制进程在接收到FTP客户发来的文件传输请求后就创建数据传送进程和数据连接，用来连接客户端和服务器端的数据传送进程。
	- 数据传送进程实际完成文件的传送，在传送完毕后关闭**数据传送连接**并结束运行。
	- ![Va7RUJ.png](https://s2.ax1x.com/2019/06/06/Va7RUJ.png)
- 两个不同的端口号
	- 当客户进程向服务器进程发出建立连接请求时，要寻找连接服务器进程的**熟知端口（21）**，同时还要高速服务器进程自己的另一个端口号码，用于建立数据传送连接。
	- 接着，服务器进程用自己传送数据的**熟知端口（20）**与客户进程所提供的端口号吗建立数据传送连接。
	- 由于FTP使用了两个不同的端口号所以数据连接与控制连接不会发生混乱。
- 使用两个不同端口号的好处
	- 使协议更加简单和更容易实现。
	- 在传输文件时还可以利用控制连接（例如，客户发送请求终止传输）
- NFS采用另一种思路
	- NFS允许应用进程打开一个远地文件，并能在该文件的某一个特定的位置上开始读写数据。
	- NFS可使用户复制一个大文件中的一个很小的片段，而不需要复制整个大文件。
	- 例如，计算机A的NFS客户软件，把要添加的数据和文件后面写数据的请求一起发送到远地的计算机B的NFS服务器。NFS服务器更新文件后返回应答信息。
	- **NFS在网络上传送的只是少量的修改数据**
##### 简单文件传送协议TFTP
- TFTP是一个很小且易于实现的文件传送协议。
- TFTP使用客户服务器方式和使用UDP数据报，因此TFTP需要有自己的差错改正措施。
- TFTP只支持文件传输而不支持交互。TFTP没有一个庞大的命令集，没有列目录的功能，也不能对用户进行身份鉴别。
- TFTP的主要特点
	- 每次传送的护具PDU中有512字节的数据，但最后一次可不足512字节。
	- 数据PDU也称为文件块，每个按序编号，从1开始
	- 支持ASCII码或二进制传送。
	- 可对文件进行读或写。
	- 使用很简单的首部。
- TFTP的工作很想停止等待协议
	- 发送完一个文件块就等待对方的确认，确认时应指明所确认的块编号
	- 发完数据后在规定的时间内收不到确认就要重发数据PDU
	- 发送确认PDU的一方若在规定时间内收到不下一个文件块，也要重发确认PDU，这样就可保证文件的传送不因某一个数据包的丢失而告失败
	- 开始工作时，TFTP客户进程发送一个读请求PDU或写请求PDU给TFTP服务器进程，器熟知端口号为69.
	- TFTP服务器进程要选择一个新的端口和TFTP客户进程进行通信。
	- 若文件长度恰好为512字节的整数倍，则文件传送完毕后，还必须在最后发送一个只含有首部而没有数据的PDU
	- 若文件长度不是512字节的整数倍，则最后PDU的数据字段一定不满512字节，这正好可作为文件结束的标志
### 万维网WWW
##### 万维网概述
- 万维网WWW并非某种特殊的网络。
- 万维网是一个大规模的联机式的**信息储藏所**
- 万维网用链接的方法能非常方便地从互联网上的一个站点访问另一个站点，从而主动地按需获取丰富的信息。
- 这种方式称为**链接**
- 万维网提供分布式服务
	- ![VaO3m6.png](https://s2.ax1x.com/2019/06/06/VaO3m6.png)
- 超媒体与超文本
	- 万维网是**分布式超媒体**系统，他是**超文本**系统的扩充
	- **一个超文本由多个信息源链接成**。利用一个连接可使用户找到另一个文档。而这些文档可以位于世界上的任何一个接在互联网上的超文本系统中。超文本是万维网的基础
	- **超媒体与超文本的区别是文档内容不同**。超文本文档仅包含文本信息，而超媒体文档还包含其他表示方式的信息，如图形，图像，声音，动画，甚至活动视频图像。
- 万维网的工作方式
	- 万维网以**客户-服务器**方式工作。
	- **浏览器**就是在用户计算机上的万维网**客户程序**。万维网文档所驻留的计算机则运行**服务器程序**，因此这个计算机也称为**万维网服务器**。
	- 客户程序向服务器程序发出请求，服务器程序向客户程序送回客户所要的**万维网文档**。
	- 在一个客户程序主窗口上显示出的万维网文档称为**页面page**
- 万维网必须解决的问题
	- 怎样标志分布在整个互联网上的万维网文档？
		- **使用统一资源定位符URL来标志万维网上的各种文档**
		- 使每一个文档在整个互联网的范围内具有唯一的标识符URL
	- 用何协议实现万维网上各种超链的连接？
		- 在万维网客户程序与万维网服务器程序之间进行交互所使用的协议是**超文本传送协议HTTP**
		- HTTP是一个应用层协议，他使用TCP连接进行可靠的传送。
	- 怎样使各种万维网的文档都在互联网上的各种计算机上显示出来，同时使用户清楚地知道什么地方存在着超链
		- 超文本标记语言HTML使得万维网页面的设计者可以很方便地用一个超链从本页面的某处连接到互联网上的任何一个万维网页面，并且能够在自己的计算机屏幕上将这些页面显示出来。
	- 怎样使用户能够很方便地找到所需的信息
		- 为了在万维网上方便的查找信息，用户可使用各种的**搜索工具**（即**搜索引擎**）
##### 统一资源定位符URL
- URL的格式
	- 资源定位符URL是对可以从互联网上得到的资源的位置和访问方法的一种简洁表示。
	- URL给资源的位置提供了提供一种抽象的认识方法，并用这种方法给资源定位。
	- 只要能够给资源定位，系统就可以对资源进行各种操作，如存取，更新，替换你和查找其属性。
	- URL相当于一个文件名在网络范围内的扩展。因此URL始于互联网相连的机器上的任何可访问对象的一个指针。
	- URL的一般形式：
		- ![VavSYD.png](https://s2.ax1x.com/2019/06/06/VavSYD.png)
		- 协议：
			- ftp——文件传送协议FTP
			- http——超文本传送协议HTTP
			- News——USENET新闻
		- “：//”是规定的格式
		- 主机：存放资源的主机在互联网中的域名
		- <端口>/<路径>：有时可以省略
- 使用HTTP的URL
	- http://<主机>:<端口>/<路径>
	- 端口号默认为80，通常成略
	- 若在省略<路径>项，则URL就指向互联网上的某个主页（home page）
##### 超文本传送协议HTTP
- HTTP的操作过程
	- 为了使超文本的链接能搞高效率的完成，需要用HTTP协议来传送一切必须的信息
	- 从层次的角度看，HTTP使**面向事务的**应用层协议，他是万维网上能够可靠地家欢文件的重要基础
- 万维网的工作过程
	- ![VavhjA.png](https://s2.ax1x.com/2019/06/06/VavhjA.png)
	- ![Vav7Af.png](https://s2.ax1x.com/2019/06/06/Vav7Af.png)
- HTTP的主要特点
	- HTTP是面向事务的客户服务器协议
	- HTTP1.0协议是**无状态的**
	- HTTP协议本身也是无连接的，虽然它使用了面向连接的TCP向上提供的服务
- 请求一个万维网文档所需的时间
	- ![VaxCNT.png](https://s2.ax1x.com/2019/06/06/VaxCNT.png)
- 持续链接
	- **HTTP/1.1协议使用持续连接**
	- 万维网服务器在发送相应后仍在一段时间内保持这条连接，使用和一个客户和该服务器可以继续在这条连接上传送后续的HTTP请求报文和响应报文。
	- 这并不局限于传送同一个页面上的链接文档，而是只要这些文档都在同一个服务器上就行。
- 持续连接的两种工作方式
	- **非流水线方式**：客户在受到前一个相应后才能发出下一个请求，这比非持续连接的两给RTT的开销节省了建立TCP连接所需的一个RTT时间。但服务器再发送玩一个对象后，其TCP连接就处于空闲状态，浪费了服务器资源。
	- **流水线方式**：客户在收到HTTP的响应报文之前就能够接着发送新的请求报文。一个接一个的请求报文到达服务器后，服务器就可连续发回响应报文。使用流水线方式时，客户访问所有的对象只需花费一个RTT时间，使TCP连接中的空闲时间减少，提高了下载文档的效率。
- 代理服务器
	- **代理服务器又称为万维网高速缓存**，它代表浏览器发出HTTP请求。
	- 万维网高速缓存把最近的一些请求和相应暂存在本地磁盘中。
	- 当与暂时存放的请求相同的新请求到达时，万维网高速缓存就把暂存的相应发送出去，而不需要按URL的地址再去互联网访问该资源。
	- ![VdpJKJ.png](https://s2.ax1x.com/2019/06/06/VdpJKJ.png)
	- ![Vdpd56.png](https://s2.ax1x.com/2019/06/06/Vdpd56.png)
	- ![VdpD2D.png](https://s2.ax1x.com/2019/06/06/VdpD2D.png)
	- ![Vdp2VI.png](https://s2.ax1x.com/2019/06/06/Vdp2VI.png)
	- ![VdpzzF.png](https://s2.ax1x.com/2019/06/06/VdpzzF.png)
	- ![Vd99sJ.png](https://s2.ax1x.com/2019/06/06/Vd99sJ.png)
- HTTP的报文节构
	- ![Vd9yWT.png](https://s2.ax1x.com/2019/06/06/Vd9yWT.png)
	- **方法是面向对象技术中使用的专门名词。所谓方法就是对所请求的对象进行的操作，因此这些方法实际上也就是一些命令。因此，请求报文的类型是由它所采用的方法决定的。**
		- HTTP请求报文的一些方法
		- ![VdFb4I.png](https://s2.ax1x.com/2019/06/06/VdFb4I.png)
	- **URL是所请求资源的URL**。
	- **版本是HTTP的版本。**
	- **响应报文的开始行是状态行**
	- **状态行包括三项内容，即HTTP的版本，状态吗，以及结束状态码的简单短语**
- **状态码都是三个数字**
	- **1xx表示通知信息的，如请求收到了或正在进行处理**
	- **2xx表示成功，如接收或知道了**
	- **3xx表示重定向，表示要完成请求还必须采取进一步的行动**
	- **3xx表示客户的差错，如请求中由错误的语法或不能完成**
	- **5xx表示服务器的差错，如服务器失效无法完成请求**
- 在服务器上存放用户的信息
	- 万维网站点使用Cookie来跟踪用户
	- Cookie表示在HTTP服务器和客户之间传递的状态信息
	- 使用Cookie的网站服务器为用户产生一个**唯一的识别码**。利用此识别码，网站就能够跟踪该用户在该网站上的活动。
##### 万维网的文档
- 超文本标记语言HTML
	- 超文本标记语言HTML中的Markup的意思就是设置标记。
	- HTML定义了许多用于**排版的命令**（即标签）
	- HTML把各种标签嵌入到万维网的页面中。这样就构成了所谓HTML文档。HTML文档是一种可以用任何文本编辑器创建的ASCII码文件。
- HTML文档
	- 仅当HTML文档以html或htm位后缀时，浏览器才对此文档的各种标签进行解释
	- 如HTML文档改为txt后缀，则HTML解释程序就不对标签进行解释，这能看见原来的文本文件
- HTML两种不同连接
	- HTML还规定了链接的设置方法。每个链接都有一个起点和终点。
	- **远程链接**：超链接的终点时其他网点上的页面。
	- **本地链接**：超链指向本计算机中的某个文件。
- XML
	- XML是可扩展标记语言，他和HTML很类似。
	- 但XML的设计宗旨是**传输数据**，而不是显示数据。
	- XML不是要替换HTML，而是对HTML的扩充。
- XHTML
	- XHTML是可扩展的超文本标记语言，它与HTML4.01几乎是相同的
	- 当XHTML是更严格的HTML版本，也是一个W3C标准，是作为一种XML应用被重新定义的HTNL，并将逐渐取代HTML
- CSS
	- CSS是层叠样式表，他是一种样式表语言，用于为HTML文档定义布局
	- CSS与HTML的区别就是HTML用于结构化内容，CSS则用于格式化结构化的内容。
- 动态万维文档
	- **静态文档**是指该文档创作完毕后就存放在万维网服务器中，在被用户浏览的过程中，内容不会改变
	- **动态文档**是指文档的内容是在浏览器访问万维网服务器时才有应用程序动态创建。
	- 动态文档和静态文档之间的主要差别体现在**服务器**一端。这主要时文档内容的生成方法不同。从浏览器的角度看，没有区别
- 万维网服务器功能的扩充
	- 应增加另一个应用程序，用来处理浏览器发来的数据，并创建动态文档
	- 应怎加一个机制，用来使万维网服务器把浏览器发来的数据传送给这个应用程序，然后万维网服务器能够解释这个应用程序的输出，并向浏览器返回HTML文档。
- 通用网关接口CGI
	- CGI是一种标准，它定义了动态文档应如何创建，输入数据应如歌提供给应用程序，以及输出结构应如何应用。
	- 万维网服务器与CGI的通信遵循CGI标准。
	- **通用**：CGI标准所定义的规则对其他任何语言都是通用的
	- **网关**：CGI程序的作用向网关
	- **接口**：有一些已经定义好的变量和调用等可供其他CGI程序使用
- CGI程序
	- CGI程序的正式名字使CGI**脚本**
	- 脚本指的是一个程序，他被另一个程序（解释程序）而不是计算机处理机来解释或执行
	- 脚本运行起来要比一般的编译程序要慢，因为它的每一条指令先要被另一个程序来处理，而不是直接被指令处理器来处理。
- 活动万维网文档
	- **活动文档技术把所有的工作都转移给浏览器端**
### 电子邮件
##### 电子邮件概述
- 电子邮件是互联网上使用的最多和最受用户欢迎的一种应用。
- 电子邮件把邮件发送到收件人使用的邮件服务器，并发在其中的收件人邮箱中，其中收件人课随时上网到自己使用的邮件服务器进行读取。
- 电子邮件的一些标准
	- 发送邮件的协议：SMTP
	- 读取邮件的协议：POP3和IMPA
	- MIME在其邮件首部中说明了邮件的数据类型，使用MIME可在邮件中同时传送多种类型的数据。
	- ![VdZtSI.png](https://s2.ax1x.com/2019/06/06/VdZtSI.png)
- 用户代理UA
	- 用户代理就是用户与电子邮件系统的接口，是电子邮件客户端软件。
	- 用户代理的**功能**：撰写，显示，处理和通信。
	- 邮件服务器的功能是发送和接收邮件，同时还要想发信人报告邮件传送的情况
	- 邮件服务器的功能是发送和接收邮件，同时还要向发信人报告邮件发送的情况
	- 邮件服务器按照**客户-服务器**方式工作，邮件服务器需要使用发送和读取两个不同的协议
- 应当注意
	- 一个邮件服务器既可以作为客户，也可以作为服务器
	- 例如，当邮件服务器A向另一个邮件服务器B发送邮件时，邮件服务器A就作位SMTP客户，而B时SMTP服务器。
	- 当邮件服务器A从另一个邮件服务器B接收邮件，邮件服务器A就作为SMTP服务器，而B是SMTP客户。
- 发送和接收电子邮件的几个重要步骤
	- 发件人调用PC中的用户代理撰写和编辑要发送的邮件
	- 发件人的用户代理把邮件用SMTP协议发给发送方邮件服务器
	- SMTP服务器把邮件临时存放在邮件缓存队列中，等待发送
	- 发送方邮件服务器的SMTP苦于与接收方邮件服务器的SMTP服务器建立TCP连接，然后就把邮件缓存队列中的邮件依次发送出去。
	- 运行在接收方邮件服务器中的SMTP服务器进程收到邮件后，把邮件放入收件人的用户邮箱中，等待收件人进行读取。
	- 收件人在打算收信时，就运行PC机中的用户代理，使用POP3或IMAP协议读取发送给自己的邮件
	- 注意：POP3服务器和POP3客户之间的通信是由POP3客户发起的。
- 电子邮件的组成
	- 电子邮件由信封和内容两部分组成
	- 电子邮件的传输程序根据邮件信封上的信息来传送邮件。用户在从自己的邮箱中读取邮件时才能见到邮件的内容
	- 在邮件的信封上，最重要的就是收件人的地址。
	- ![VwOytO.png](https://s2.ax1x.com/2019/06/07/VwOytO.png)
##### 简单邮件传送协议SMTP
- SMTP所规定的就是在两个相互通信的SMTP进程之间应如何交换信息。
- 由于SMTP使用客户服务器方式，因此负责发送邮件的SMTP进程就是SMTP客户，而负责接收邮件的SMTP进程就是SMTP服务器。
- SMTP规定了14条命令和21种应答信息。每条命令用4个字母组成，而每一种应答信息只有一行信息，由一个三位数字的代码开始。
- SMTP通信的三个阶段
	- **连接建立**：连接是在发送主机的SMTP客户和接受主机的SMTP服务器之间建立的。**SMTP不使用中间的邮件服务器**
	- **邮件传送**
	- **连接释放**
##### 电子邮件的信息格式
- 一个电子邮件分为信封和内容两大部分。
- RFC 822只规定了邮件内容中的首部格式，而对邮件的主体部分则让用户自由撰写。
##### 邮件读取协议POP3和IMAP
- 邮局协议POP是一个非常简单，但功能有限的邮件读取协议，现在使用的是他的第三个版本POP3
- POP也使用客户-服务器工作方式。
- 在接收邮件的用户PC种必须运行POP客户程序，而在用户所连接的ISP的邮件服务器中则运行POP服务器程序
- IMAP协议
	- IMAP也是按**客户-服务器**方式工作，最新的版本是4
	- 用户在自己的PC机上就可以操纵ISP的邮件服务器的邮箱，就像在本地操纵一样。
	- **IMPA是一个联机协议**
- IMAP特点
	- IMAP最大的好处就是用户可以在不同的地方使用不同的计算机随时上网阅读和处理自己的邮件。
	- IMAP还允许收件人只读取邮件中的某一个部分。
	- IMAP的缺点是如果用户没有将邮件复制到自己的PC上，则邮件一直是存放在IMAP服务器上。因此用户需要经常与IMAP服务器建立连接。
- 必须注意
	- 不要讲邮件读取协议POP或IMAP与邮件传送协议SMTP弄混。
	- 发信人的用户代理向源邮件服务器发送邮件，以及源邮件服务器向目的邮件服务器发送邮件，都是用SMTP协议
	- 而POP协议或IMAP协议则是用户从目的邮件服务器上读取邮件所使用的协议。
##### 基于万维网的电子邮件
- 电子邮件从A发送到网易邮件服务器**使用HTTP协议**
- 两个邮件服务器之间的传送使用SMTP。
- 邮件从新浪邮件服务器传送到B使用HTTP协议
- **万维网电子邮件的好处：只要能够找到上网的计算机，打开任何一种浏览器就可以非常方便地收发电子邮件**
### 动态主机配置协议DHCP
- 为了将软件协议做成通用的和便于移植，协议软件的编写者把协议软件参数化。这就使得在很多台计算机上使用同一个经过编译的二进制代码称为可能。
- 一台计算机和另一台计算机的区别，都可通过一些不同的参数来体现。
- 在软件协议运行之前，必须给每一个参数赋值
- 协议配置
	- 在协议软件种给这些参数复制的动作叫做**协议配置**
	- 一个软件协议在使用之前必须是已经正确配置的
	- 具体的配置信息有哪些则取决于协议栈
	- 需要配置的项目
		- IP地址
		- 子网掩码
		- 默认路由器的IP地址
		- 域名服务器的IP地址
	- 这些信息通常存储在一个配置文件中，计算机在引导过程中可以对这个文件进行存取
- 动态主机配置协议DHCP
	- **互联网广泛使用动态主机配置协议DHCP提供了即插即用连网的机制**
	- 这种机制允许一台计算机加入新的网络和获取IP地址而不用手工参与
- DHCP使用客户-服务器方式
	- 需要IP地址的主机启动时就像DHCP服务器**广播发送**发现报文，这时该主机就成为DHCP客户
	- 本地网络上所有主机都能收到此广播报文，但只有DHCP服务器才回答此报文
	- DHCP服务器现在起数据库中查找该计算机的配置信息。若找到，则返回找到的信息。若找不到，则从服务器的IP地址池种取一个地址分配给该计算机。DHCP服务器的回答报文叫做提供报文
- DHCP中继代理
	- 并不是每个网络上都有DHCP服务器，这样会使DHCP服务器的数量太多。现在是每一个网络至少有一个DHCP中继代理，它配置了DHCP服务器的IP地址信息。
	- 当DHCP中继代理收到主机发送的发现报文后，就以单播方式向DHCP服务器转发此报文，并等待其回答。收到DHCP服务器回答的提供报文后，DHCP中继代理再将此提供保温发回给主机。
	- **DHCP中继代理以单播方式转发发现的报文**
	- DHCP报文只是UDP用户数据报中的数据。
- 租用期	
	- DHCP服务器分配给DHCP客户的IP地址使**临时的**，因此DHCP客户只能在一段有限的时间内是哟个这个分配到的IP地址，DHCP协议称为这段时间位**租用期**

- 链接：https://www.nowcoder.com/questionTerminal/4213a080d42f4ad384b86503076f2158?toCommentId=524462
- 来源：牛客网

- 第一次启动登录网络时的初始化租约过程

- 当DHCP客户机启动登录网络时通过以下步骤从 DHCP 服务器获得租约：

- 1.DHCP 客户机在本地子网中先发送 DHCP discover 信息，此信息以广播的形式发送，因为客户机现在不知道DHCP服务器的IP地址。

- 2.在 DHCP 服务器收到DHCP客户机广播的 DHCP discover 信息后，它向DHCP客户机发送 DHCP offer 信息，其中包括一个可租用的 IP 地址

- 3.如果没有 DHCP 服务器对客户机的请求作出反应，可能发生以下两种情况：

- §如果客户使用的是 Windows 2000 操作系统且自动设置IP地址的功能处于激活状态，那么客户机自动给自己分配一个 IP 地址。

- §如果使用其它的操作系统或自动设置 IP 地址的功能被禁止，则客户机无法获得 IP 地址，初始化失败。但客户机在后台每隔 5 分钟发送四次 DHCP - discover 信息直到它收到 DHCP offer 信息。

- 4.一旦客户机收到 DHCP offer 信息，它发送 DHCP request 信息到服务器表示它将使用服务器所提供的 IP 地址

- 5.DHCP 服务器在收到 DHCP request 信息后，即发送 DHCP positive 确认信息，以确定此租约成立，且此信息中还包含其它 DHCP 选项信息。

- 6.客户机收到确认信息后，利用其中的信息配制它的 TCP/IP 属性并加入到网络中。 如图所示是 DHCP 客户机从 DHCP 服务器获得租约的过程

- 7.当客户机请求的是一个无效的或重复的 IP 地址，则 DHCP 服务器在第五步发送 DHCP negative 确认信息，客户机收到 DHCP negative 确认信息初始化失败